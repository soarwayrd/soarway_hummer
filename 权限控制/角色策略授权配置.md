>角色策略授权配置

1. 在**Soarway.Hummer.SmartBuilding.API**项目`Startup.cs`配置如下
   ### Startup.cs
   ```C#
   services.AddAuthorization(options =>
    {
        options.AddPolicy("RBAC", policy =>
        policy.Requirements.Add(new RBACAuthorizationRequirement()));
    });
   services.AddSingleton<IAuthorizationHandler, RBACAuthorizationRequirementHandler>();
   ```
2. 创建RBACAuthorizationRequirement.cs继承`IAuthorizationRequirement`
   ```C#
   public class RBACAuthorizationRequirement : IAuthorizationRequirement
    {
        public RBACAuthorizationRequirement()
        {
           
        }
    }
   ```
3. RBACAuthorizationRequirementHandler.cs实现`AuthorizationHandler<RBACAuthorizationRequirement>`
   ```C#
   public class RBACAuthorizationRequirementHandler : AuthorizationHandler<RBACAuthorizationRequirement>
    {
       protected override Task HandleRequirementAsync(AuthorizationHandlerContext context, RBACAuthorizationRequirement requirement)
        {
           //获取Token里的user_id
           var user_id = context.User.HasClaim(c => c.Value == "user_id");
           // TODO: 需要处理业务逻辑在这里编写接口权限验证请求
           context.Succeed(requirement);//验证成功返回

           return Task.CompletedTask;
        }
    }
    ```
4. Controller配置在方法打上``Authorize(Policy = "RBAC")``
   ```C#
    [Authorize(Policy = "RBAC")]
    [HttpGet]
    [ProducesResponseType(typeof(UserQueryResultDTO), StatusCodes.Status200OK)]
    public IActionResult Single(int userID)
     {
         Expression<Func<User, bool>> expression = t => t.Enable == true && t.UserID == userID;
        UserQueryResultDTO output = Mapper.Map<User, UserQueryResultDTO>(UserRepository.GetBySpecification(expression));
        
         return new JsonResult(output);
     }
   ```
5. 角色策略授权配置主要是了为满足接口除了Controller验证Authorize以外的权限校验。